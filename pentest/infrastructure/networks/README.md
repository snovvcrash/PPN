# Network

* [https://github.com/frostbits-security/MITM-cheatsheet](https://github.com/frostbits-security/MITM-cheatsheet)




## Sniff Traffic



### tcpdump

While connected via SSH:

```
$ sudo tcpdump -i eth0 -w dump.pcap -s0 'not tcp port 22' &
```



### Wireshark

* [https://research.801labs.org/cracking-an-ntlmv2-hash/](https://research.801labs.org/cracking-an-ntlmv2-hash/)


#### Filters

Protocols to consider:

* [DTP](https://en.wikipedia.org/wiki/Dynamic_Trunking_Protocol) (Dynamic Trunking Protocol)
* [OSPF](https://en.wikipedia.org/wiki/Open_Shortest_Path_First) (Open Shortest Path First)
* [SSDP](https://en.wikipedia.org/wiki/Simple_Service_Discovery_Protocol) (Simple Service Discovery Protocol)
* [ARP](https://en.wikipedia.org/wiki/Address_Resolution_Protocol) (Address Resolution Protocol)
* [LLMNR](https://en.wikipedia.org/wiki/Link-Local_Multicast_Name_Resolution) (Link-Local Multicast Name Resolution)
* [NBNS](https://en.wikipedia.org/wiki/NetBIOS_over_TCP/IP) (NetBIOS Name Service)
* [mDNS](https://en.wikipedia.org/wiki/Multicast_DNS) (Multicast DNS)
* [ICMPv6](https://en.wikipedia.org/wiki/Internet_Control_Message_Protocol_for_IPv6) (Internet Control Message Protocol version 6)
* [DHCPv6](https://en.wikipedia.org/wiki/DHCPv6) (Dynamic Host Configuration Protocol version 6)

```
dtp || ospf || ssdp || arp || llmnr || nbns || mdns || icmpv6 || dhcpv6
```

Arpspoof:

```
(http || ftp || smb || smb2 || ldap) && ip.src == VICTIM_10.0.0.5
```
